@PostMapping(value = "/multipart-scan", consumes = MediaType.MULTIPART_FORM_DATA_VALUE)
public ResponseEntity<FileDto.Response> scanMultipartFile(
        @RequestHeader("X-CVC-API-KEY") String apiKey,
        @RequestPart("file") MultipartFile file) {

    logger.info("Multipart file scan requested. Filename: {}, API Key: {}", file.getOriginalFilename(), apiKey);
    if (!v3ScannerService.validateApiKey(apiKey)) {
        logger.warn("Unauthorized access attempt with API Key: {}", apiKey);
        return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(
                FileDto.Response.builder()
                        .fileName(file.getOriginalFilename())
                        .returnCode(HttpStatus.UNAUTHORIZED.value())
                        .message("Unauthorized: Invalid API Key")
                        .build()
        );
    }

    // 서비스 호출
    FileDto.Response response = v3ScannerService.scanMultipartFile(file);
    return ResponseEntity.status(HttpStatus.OK).body(response);
}
