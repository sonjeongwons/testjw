@PostMapping(value = "/binary-scan", consumes = MediaType.APPLICATION_OCTET_STREAM_VALUE)
public ResponseEntity<FileDto.Response> scanBinaryFile(
        @RequestHeader("X-CVC-API-KEY") String apiKey,
        @RequestHeader("File-Name") String fileName,  // 파일 이름 메타데이터를 헤더로 받음
        @RequestBody byte[] fileData) {  // 파일 데이터를 바이너리로 받음

    logger.info("Binary file scan requested. Filename: {}, API Key: {}", fileName, apiKey);
    if (!v3ScannerService.validateApiKey(apiKey)) {
        logger.warn("Unauthorized access attempt with API Key: {}", apiKey);
        return ResponseEntity.status(HttpStatus.UNAUTHORIZED).body(
                FileDto.Response.builder()
                        .fileName(fileName)
                        .returnCode(HttpStatus.UNAUTHORIZED.value())
                        .message("Unauthorized: Invalid API Key")
                        .build()
        );
    }

    // 바이너리 파일 스캔 처리
    FileDto.Response response = v3ScannerService.scanBinaryFile(fileName, fileData);
    return ResponseEntity.status(HttpStatus.OK).body(response);
}
