import socket

def lambda_handler(event, context):
    try:
        with socket.create_connection(("172.31.10.25", 3003), timeout=3) as sock:
            msg = b"ping"
            sock.sendall(msg)
            resp = sock.recv(1024)
        return {
            "statusCode": 200,
            "body": f"Connected to EC2. Response: {resp.decode()}"
        }
    except Exception as e:
        return {
            "statusCode": 500,
            "body": f"Connection failed: {str(e)}"
        }