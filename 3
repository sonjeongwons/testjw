apiVersion: networking.istio.io/v1alpha3
kind: EnvoyFilter
metadata:
  name: add-headers
  namespace: your-namespace
spec:
  workloadSelector:
    labels:
      app: your-app-label
  configPatches:
  - applyTo: HTTP_FILTER
    match:
      context: SIDECAR_OUTBOUND
      listener:
        filterChain:
          filter:
            name: "envoy.http_connection_manager"
    patch:
      operation: INSERT_BEFORE
      value:
        name: envoy.lua
        typed_config:
          "@type": type.googleapis.com/envoy.extensions.filters.http.lua.v3.Lua
          inlineCode: |
            function envoy_on_request(request_handle)
              request_handle:headers():add("X-Custom-Header", "MyValue")
            end




Nuri SCF에서 LLM Endpoint 호출 시, 빌링/접근제어를 위해 해당 함수의 Account ID 정보 헤더로 전달 필요
EnvoyFilter를 통해 특정 헤더를 후처리로 처리 가능


AIOS는 LLM Endpoint를 HTTPS 프로토콜로 제공
TLS 암호화된 HTTPS 프로토콜에 대해서는 헤더값 추가 불가
